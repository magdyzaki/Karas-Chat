# استكشاف أخطاء التنبيه (لا يظهر سواء الشاشة مطفية أو مضيئة)

---

## 1) تنبيه مع الشاشة مضيئة (الصفحة مفتوحة)

- **اسمح بالإشعارات** عندما يطلب المتصفح بعد تسجيل الدخول.
- **اترك الصفحة مفتوحة** واختر وقت تنبيه بعد دقيقتين أو ثلاث، ثم انتظر حتى يحين الموعد (يفترض خلال نحو 15 ثانية بعد الموعد يظهر شريط «تنبيه» في أعلى الصفحة و/أو إشعار النظام).
- لو لم يظهر شيء: اضغط **«تحديث»** في الصفحة — هذا يجلب التنبيهات من السيرفر وأي تنبيه فات وقته يفترض أن يظهر فوراً.
- لو سبق أن ظهر تنبيه لنفس الموعد (أو التطبيق اعتقد أنه أُطلق)، لا يعيد إظهاره. اضغط **«مسح سجل التنبيهات (للاختبار)»** ثم **«تحديث»** — أو سجّل خروجاً ثم دخولاً من جديد، ثم أضف تنبيهاً جديداً بوقت قريب.

---

## 2) تنبيه مع الشاشة مطفية (Push)

- يجب أن تكون قد **سمحت بالإشعارات** عند أول تسجيل دخول بعد نشر الباكند الذي يدعم Push.
- على **Koyeb** تأكد من وجود **VAPID_PUBLIC_KEY** و **VAPID_PRIVATE_KEY** في Environment.
- السيرفر يتحقق كل **دقيقة** من المواعيد ويرسل Push؛ لذلك قد يصل الإشعار بعد الموعد بدقيقة تقريباً.
- جرّب: أضف تنبيهاً بعد 2–3 دقائق، **اخرج من المتصفح أو اطفئ الشاشة**، وانتظر حتى بعد الموعد بدقيقة.

---

## 3) قاعدة البيانات على Koyeb

- على Koyeb قد تُحفظ البيانات في مجلد مؤقت. إذا تم **إعادة نشر (Redeploy)** أو إعادة تشغيل الخدمة، أحياناً تُفقد الحسابات والتنبيهات والاشتراكات.
- في هذه الحالة: **سجّل دخولاً من جديد**، أضف تنبيهاً جديداً، واسمح بالإشعارات مرة أخرى، ثم جرّب.

---

## 4) ملخص سريع

| المشكلة              | ما تفعله |
|----------------------|----------|
| لا يظهر تنبيه والصفحة مفتوحة | اسمح بالإشعارات، انتظر بعد الموعد، أو اضغط «تحديث». |
| لا يظهر تنبيه والشاشة مطفية | تأكد من VAPID على Koyeb، وسماحك بالإشعارات، وانتظر حتى دقيقة بعد الموعد. |
| فقدان الحساب أو التنبيهات | أعد التسجيل وإضافة تنبيه واختبار مرة أخرى. |
